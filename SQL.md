# SQL statements used to initialize database tables

```
CREATE TABLE USER(UID integer AUTO_INCREMENT PRIMARY KEY, USERNAME varchar(20) UNIQUE NOT NULL, PASSWORD varchar(20) NOT NULL, ISADMIN BOOL default 0 NOT NULL, ISVERIFIED BOOL default 1 NOT NULL);

CREATE TABLE ERA(EID integer AUTO_INCREMENT PRIMARY KEY, ERANAME varchar(20) UNIQUE NOT NULL);  

CREATE TABLE CNDTN(CNID integer AUTO_INCREMENT PRIMARY KEY, CNDTNNAME varchar(20) UNIQUE NOT NULL);

CREATE TABLE OBJECT(OID integer AUTO_INCREMENT PRIMARY KEY, OBJECTNAME varchar(45) NOT NULL, DESCRIPTION varchar(400), TYPE enum('c', 'p') NOT NULL, CNID integer, FOREIGN KEY (CNID) REFERENCES CNDTN(CNID) ON UPDATE CASCADE ON DELETE SET NULL, EID integer, FOREIGN KEY (EID) REFERENCES ERA(EID) ON UPDATE CASCADE ON DELETE SET NULL, CHECKEDOUTTO integer, FOREIGN KEY (CHECKEDOUTTO) REFERENCES USER(UID) ON UPDATE CASCADE ON DELETE SET NULL);

CREATE TABLE COSTUME(OID integer PRIMARY KEY, FOREIGN KEY (OID) REFERENCES OBJECT(OID) ON UPDATE CASCADE ON DELETE CASCADE, SIZE ENUM('XS', 'S', 'M', 'L', 'XL', '2XL', '3XL') NOT NULL);

CREATE TABLE PROP(OID integer PRIMARY KEY, FOREIGN KEY (OID) REFERENCES OBJECT(OID) ON UPDATE CASCADE ON DELETE CASCADE, DIMENSION varchar(30) NOT NULL);

CREATE TABLE AUDITACTION(AAID integer AUTO_INCREMENT PRIMARY KEY, AUDITACTIONNAME varchar(20) UNIQUE NOT NULL);

CREATE TABLE AUDIT(AID integer AUTO_INCREMENT PRIMARY KEY, AAID integer NOT NULL, FOREIGN KEY (AAID) REFERENCES AUDITACTION(AAID) ON UPDATE CASCADE ON DELETE CASCADE, TIME DATETIME NOT NULL, OID integer, FOREIGN KEY (OID) REFERENCES OBJECT(OID) ON UPDATE CASCADE ON DELETE CASCADE, UID integer, FOREIGN KEY (UID) REFERENCES USER(UID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE PICTURE(PID integer AUTO_INCREMENT PRIMARY KEY, OID integer NOT NULL, FOREIGN KEY (OID) REFERENCES OBJECT(OID) ON UPDATE CASCADE ON DELETE CASCADE, IMAGE VARCHAR(100) NOT NULL, OBJORDER integer NOT NULL);

CREATE TABLE COLOR(CID integer AUTO_INCREMENT PRIMARY KEY, COLORNAME varchar(20) UNIQUE NOT NULL);

CREATE TABLE OBJECTCOLOR(OID integer, FOREIGN KEY (OID) REFERENCES OBJECT(OID) ON UPDATE CASCADE ON DELETE CASCADE, CID integer, FOREIGN KEY (CID) REFERENCES COLOR(CID) ON UPDATE CASCADE ON DELETE CASCADE, PRIMARY KEY(OID, CID));
```

# SQL statements used to add test data to database

```
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Login");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Create Account");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Add Object");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Modify Object");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Delete Object");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Checkout Object");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Checkin Object");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Approve User");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Add Era");
INSERT INTO AUDITACTION(AUDITACTIONNAME) VALUES ("Add Color");

INSERT INTO ERA(EID, ERANAME) VALUES (1, "Medieval");
INSERT INTO ERA(EID, ERANAME) VALUES (2, "Edo");
INSERT INTO ERA(EID, ERANAME) VALUES (3, "Modern"); 

INSERT INTO CNDTN(CNID, CNDTNNAME) VALUES (1, "New");
INSERT INTO CNDTN(CNID, CNDTNNAME) VALUES (2, "Excellent");
INSERT INTO CNDTN(CNID, CNDTNNAME) VALUES (3, "Good");
INSERT INTO CNDTN(CNID, CNDTNNAME) VALUES (4, "Decent");
INSERT INTO CNDTN(CNID, CNDTNNAME) VALUES (5, "Bad");
INSERT INTO CNDTN(CNID, CNDTNNAME) VALUES (6, "Unusable");

INSERT INTO COLOR(CID, COLORNAME) VALUES (1, "Gold");
INSERT INTO COLOR(CID, COLORNAME) VALUES (2, "Gray");
INSERT INTO COLOR(CID, COLORNAME) VALUES (3, "Red");
INSERT INTO COLOR(CID, COLORNAME) VALUES (4, "Yellow");
INSERT INTO COLOR(CID, COLORNAME) VALUES (5, "Brown");

INSERT INTO USER(USERNAME, PASSWORD) VALUES ("user", "user");
INSERT INTO USER(USERNAME, ISADMIN, PASSWORD) VALUES ("admin", 1, "admin");

INSERT INTO OBJECT(OID, OBJECTNAME, DESCRIPTION, TYPE, CNID, EID) VALUES (1, "Crown", "Shiny, pointy, and goes on head", 'c', 3, 1);
INSERT INTO OBJECT(OID, OBJECTNAME, DESCRIPTION, TYPE, CNID, EID) VALUES (2, "Broadsword", "A big sword for swinging around", 'p', 5, 1);
INSERT INTO OBJECT(OID, OBJECTNAME, DESCRIPTION, TYPE, CNID, EID) VALUES (3, "Katana", "For when just wearing all black doesn't make you NINJA enough", 'p', 2, 2);
INSERT INTO OBJECT(OID, OBJECTNAME, DESCRIPTION, TYPE, CNID, EID) VALUES (4, "Cape", "NO CAPES!", 'c', 2, 3);
INSERT INTO OBJECT(OID, OBJECTNAME, DESCRIPTION, TYPE, CNID, EID) VALUES (5, "Sunglasses", "For blocking bright lights or just to look cool", 'c', 3, 3);
INSERT INTO OBJECT(OID, OBJECTNAME, DESCRIPTION, TYPE, CNID, EID) VALUES (6, "Trebuchet", "To launch Pumpkin Kid aerially into your enemies", 'p', 5, 1);

INSERT INTO OBJECTCOLOR(OID, CID) VALUES (1, 1);
INSERT INTO OBJECTCOLOR(OID, CID) VALUES (2, 2);
INSERT INTO OBJECTCOLOR(OID, CID) VALUES (3, 2);
INSERT INTO OBJECTCOLOR(OID, CID) VALUES (4, 3);
INSERT INTO OBJECTCOLOR(OID, CID) VALUES (5, 4);
INSERT INTO OBJECTCOLOR(OID, CID) VALUES (6, 5);

INSERT INTO COSTUME(OID, SIZE) VALUES (1, 'L');
INSERT INTO COSTUME(OID, SIZE) VALUES (4, 'S');
INSERT INTO COSTUME(OID, SIZE) VALUES (5, '3XL');

INSERT INTO PROP(OID, DIMENSION) VALUES (2, '1x1x1');
INSERT INTO PROP(OID, DIMENSION) VALUES (3, '2x7x8');
INSERT INTO PROP(OID, DIMENSION) VALUES (6, '5x8x10');
```
# Application Queries
Login Query
```
SELECT UID FROM USER WHERE NAME = $name$ AND PASSWORD = $password$ AND ISVERIFIED = 1;
```
User Registration Query
```
INSERT INTO USER(NAME, PASSWORD) VALUES ($name$, $password$);
```
Admin Registration Query
```
INSERT INTO USER(NAME, PASSWORD, ISADMIN) VALUES ($name$, $password$, 1);
```
Search Query (with filters)
```
SELECT * FROM OBJECT WHERE NAME = $searchName$ [AND TYPE = 'c' | AND TYPE = 'p'] [AND CNDTN = 'New' | AND CNDTN = 'Good' | AND CNDTN = 'Decent' | AND CNDTN = 'Excellent' | AND CNDTN = 'Bad' | AND CNDTN = 'Unusable'] [AND ERA = $era$] [AND NOT (CHECKEDOUTTO = NULL)];
```
Edit Object Query
```
UPDATE OBJECT SET [TYPE = 'c' | TYPE = 'p'] [CNDTN = 'New' | CNDTN = 'Good' | CNDTN = 'Decent' | CNDTN = 'Excellent' | CNDTN = 'Bad' | CNDTN = 'Unusable'] [ERA = $era$] [CHECKOUTTO = $uid$] WHERE OID = $objID$;
```
Add Picture Query
```
INSERT INTO PICTURE(OID, IMAGE) VALUES ($oid$, $imageBlob$);
```
View Logs
```
SELECT * FROM AUDIT WHERE [ACTION = $auditaction$] [OBJECT = $oid$] [USER = $uid$];
```
Remove Object
```
DELETE FROM OBJECT WHERE OID = $oid$;
```
Remove User
```
DELETE FROM USER WHERE UID = $uid$;
```
Get Objects and its pictures
```
SELECT * FROM OBJECT NATURAL JOIN PICTURE
```
